# Environment Configuration Template for Fly.io Production Deployment
# Copy this file to .env.production and fill in your actual values

# =============================================================================
# APPLICATION SETTINGS
# =============================================================================
APP_ENV=production
DEBUG=false
LOG_LEVEL=INFO
STRUCTURED_LOGGING=true

# Server configuration
SERVER_HOST=0.0.0.0
SERVER_PORT=8080
MAX_WORKERS=4
WORKER_TIMEOUT=300

# =============================================================================
# SECURITY & AUTHENTICATION
# =============================================================================

# Descope OAuth 2.1 + PKCE Configuration
DESCOPE_PROJECT_ID=your-descope-project-id-here
DESCOPE_DOMAIN=your-descope-domain.descope.com
DESCOPE_CLIENT_ID=your-descope-client-id-here
DESCOPE_CLIENT_SECRET=your-descope-client-secret-here

# JWT Configuration
JWT_SECRET_KEY=generate-a-secure-random-secret-key-here
JWT_ALGORITHM=HS256
JWT_ACCESS_TOKEN_EXPIRE_MINUTES=1440

# CORS Configuration (adjust for your domains)
CORS_ORIGINS=https://autonomous-software-foundry.fly.dev,https://asf-staging.fly.dev
CORS_ALLOW_CREDENTIALS=true

# =============================================================================
# DATABASE CONFIGURATION
# =============================================================================

# PostgreSQL (Fly.io will auto-set DATABASE_URL)
# These are fallback/override values if needed
DB_POOL_SIZE=5
DB_MAX_OVERFLOW=10
DB_POOL_TIMEOUT=30
DB_POOL_RECYCLE=3600
DB_ECHO=false

# =============================================================================
# CACHE CONFIGURATION
# =============================================================================

# Redis (Fly.io will auto-set REDIS_URL)
# These are configuration values
CACHE_DEFAULT_TTL=3600
CACHE_KEY_PREFIX=asf:
CACHE_MAX_KEY_SIZE=250

# =============================================================================
# CEQUENCE AI GATEWAY INTEGRATION
# =============================================================================

# Cequence Analytics Configuration
CEQUENCE_GATEWAY_ID=your-cequence-gateway-id-here
CEQUENCE_API_KEY=your-cequence-api-key-here
CEQUENCE_ENDPOINT=https://your-cequence-endpoint.com
CEQUENCE_ENABLE_ANALYTICS=true

# Request tracking
ENABLE_REQUEST_TRACKING=true
CORRELATION_ID_HEADER=X-Correlation-ID

# =============================================================================
# LLM PROVIDER CONFIGURATION
# =============================================================================

# OpenAI Configuration
OPENAI_API_KEY=your-openai-api-key-here
OPENAI_MODEL=gpt-4-turbo-preview
OPENAI_MAX_TOKENS=4096
OPENAI_TEMPERATURE=0.1

# Anthropic Configuration (Alternative)
ANTHROPIC_API_KEY=your-anthropic-api-key-here
ANTHROPIC_MODEL=claude-3-sonnet-20240229
ANTHROPIC_MAX_TOKENS=4096

# LLM Usage Limits
LLM_DAILY_COST_LIMIT=100.00
LLM_HOURLY_REQUEST_LIMIT=1000
LLM_ENABLE_COST_TRACKING=true

# =============================================================================
# MONITORING & OBSERVABILITY
# =============================================================================

# Prometheus Metrics
ENABLE_METRICS=true
METRICS_PORT=9091
METRICS_PATH=/metrics

# Structured Logging
LOG_FORMAT=json
LOG_CORRELATION_ID=true
LOG_INCLUDE_TRACE=true

# Health Check Configuration
HEALTH_CHECK_TIMEOUT=10
HEALTH_CHECK_DEEP=true

# =============================================================================
# SELF-HEALING SYSTEM
# =============================================================================

# Health Monitoring
HEALTH_CHECK_INTERVAL=60
HEALTH_SCORE_THRESHOLD=0.7
ENABLE_AUTO_HEALING=true

# Error Analysis
ERROR_ANALYSIS_ENABLED=true
ERROR_PATTERN_LEARNING=true
ERROR_CORRELATION_WINDOW=3600

# Solution Generation
SOLUTION_CONFIDENCE_THRESHOLD=0.8
ENABLE_AUTOMATIC_FIXES=false  # Set to true after testing
HEALING_MAX_ATTEMPTS=3

# =============================================================================
# AGENT ORCHESTRATION
# =============================================================================

# Agent Configuration
ENABLE_AGENT_ORCHESTRATION=true
MAX_CONCURRENT_AGENTS=3
AGENT_TIMEOUT=1800
AGENT_RETRY_ATTEMPTS=2

# Code Generation Limits
MAX_FILE_SIZE=100000
MAX_PROJECT_FILES=1000
CODE_GENERATION_TIMEOUT=600

# =============================================================================
# RATE LIMITING & SECURITY
# =============================================================================

# Rate Limiting
RATE_LIMIT_ENABLED=true
RATE_LIMIT_REQUESTS_PER_MINUTE=100
RATE_LIMIT_BURST_SIZE=20

# Security Headers
SECURITY_HEADERS_ENABLED=true
HSTS_MAX_AGE=31536000
CSP_ENABLED=true

# API Security
API_KEY_REQUIRED=false
MAX_REQUEST_SIZE=10485760  # 10MB
REQUEST_TIMEOUT=30

# =============================================================================
# FEATURE FLAGS
# =============================================================================

# Experimental Features
ENABLE_EXPERIMENTAL_FEATURES=false
ENABLE_BETA_HEALING=true
ENABLE_ADVANCED_ANALYTICS=true

# MCP Protocol Features
MCP_PROTOCOL_VERSION=2024-11-05
ENABLE_MCP_SUBSCRIPTIONS=true
ENABLE_MCP_STREAMING=true

# =============================================================================
# PERFORMANCE TUNING
# =============================================================================

# Connection Limits
MAX_CONCURRENT_CONNECTIONS=100
CONNECTION_TIMEOUT=30
KEEPALIVE_TIMEOUT=5

# Processing Limits
MAX_PROCESSING_TIME=300
BACKGROUND_TASK_TIMEOUT=600

# Memory Management
MAX_MEMORY_USAGE_MB=400  # 80% of 512MB VM
GARBAGE_COLLECTION_THRESHOLD=0.8

# =============================================================================
# BACKUP & RECOVERY
# =============================================================================

# Database Backup
ENABLE_AUTO_BACKUP=true
BACKUP_RETENTION_DAYS=7
BACKUP_FREQUENCY=daily

# Configuration Backup
CONFIG_BACKUP_ENABLED=true
BACKUP_ENCRYPTION_KEY=generate-backup-encryption-key-here

# =============================================================================
# NOTIFICATION & ALERTING
# =============================================================================

# Slack Integration (Optional)
SLACK_WEBHOOK_URL=your-slack-webhook-url-here
SLACK_CHANNEL=#autonomous-software-foundry
ENABLE_SLACK_ALERTS=false

# Email Notifications (Optional)
SMTP_HOST=smtp.your-provider.com
SMTP_PORT=587
SMTP_USERNAME=your-smtp-username
SMTP_PASSWORD=your-smtp-password
NOTIFICATION_EMAIL=admin@your-domain.com

# =============================================================================
# DEVELOPMENT OVERRIDES
# =============================================================================
# These settings can override defaults for specific environments

# Development/Testing
SKIP_AUTH_FOR_HEALTH_CHECKS=true
ENABLE_DEBUG_ENDPOINTS=false
MOCK_LLM_RESPONSES=false

# Performance Testing
LOAD_TEST_MODE=false
SIMULATE_DELAYS=false

# =============================================================================
# FLY.IO SPECIFIC CONFIGURATION
# =============================================================================

# These are automatically set by Fly.io but can be referenced
# FLY_APP_NAME=autonomous-software-foundry
# FLY_REGION=ord
# DATABASE_URL=postgres://... (auto-set by Fly.io)
# REDIS_URL=redis://... (auto-set by Fly.io)

# Fly.io VM Configuration
FLY_VM_MEMORY_MB=512
FLY_CPU_CORES=1
FLY_DISK_SIZE_GB=1

# Regional Settings
PRIMARY_REGION=ord
FALLBACK_REGIONS=ams,sin,lax